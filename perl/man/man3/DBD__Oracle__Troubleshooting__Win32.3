.\" Automatically generated by Pod::Man 4.10 (Pod::Simple 3.35)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "DBD::Oracle::Troubleshooting::Win32 3"
.TH DBD::Oracle::Troubleshooting::Win32 3 "2014-04-25" "perl v5.28.1" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
DBD::Oracle::Troubleshooting::Win32 \- Tips and Hints to Troubleshoot DBD::Oracle on Win32
.SH "VERSION"
.IX Header "VERSION"
version 1.74
.SH "GENERAL INFO"
.IX Header "GENERAL INFO"
In general, on Windows, it's best to just use ActiveState Perl and the
\&\s-1PPM\s0 package manager to install a pre-built version of DBD::Oracle however only version 1.17 is available there.
.SH "Oracle Instant Client 11.1.0.6.0 Notes"
.IX Header "Oracle Instant Client 11.1.0.6.0 Notes"
So far I have managed to get it to Makefile and compile test and install and work.  However it seems one needs to set \*(L"\s-1NLS_LANG\*(R"\s0 to a valid value  
in the environment variables.
.PP
As well \s-1IC 11\s0 seems to have trouble finding the .ORA files. A quick fix for this is to add \*(L"\s-1TNS_ADMIN\*(R"\s0 
to the environment variables and point it to where your .ORA files are.
.SH "Other information, some of which is out of date \-\-\-"
.IX Header "Other information, some of which is out of date ---"
.Vb 3
\&    DBD\-Oracle for Windows and Oracle Instantclient and 10XE (Express Edition)
\&    By: John Scoles 
\&    The Pythian Group
.Ve
.PP
The preferred method of getting DBD::Oracle is to use a pre-built version from the ActiveState 
repository, which can be installed with \s-1PPM.\s0
.PP
Compiling and installing DBD::Oracle 1.18 or later on a windows 2000 professional or \s-1XP OS\s0 for use 
with Oracle instantClient ver 10.2.0.1 & 10.1.0.5 or Oracle \s-1XE\s0 requires only a few downloads and 
a minimal number of environment setting.  The procedures below were tested on a clean 
Windows platform having no Oracle or other development environment installed.
.PP
.Vb 2
\&    1) The first part of the process is to download and install the latest version of 
\&    Active Perl from http://www.activeperl.com/.
\&
\&    2) Use the PPM application to get the latest version of DBI
\&
\&    3) Download the latest DBD::Oracle from http://svn.perl.org/modules/dbd\-oracle/trunk/
\&
\&    4) Download and unzip the Oracle Instant Client (10.2.0.1 or 10.1.0.5) 32 bit from 
\&    http://www.oracle.com/technology/tech/oci/instantclient/instantclient.html 
\&    You will need all three of these products
\&        i.      Instant Client Package \- Basic
\&        ii.     Instant Client Package \- SQL*Plus:
\&        iii.    Instant Client Package \- SDK:
\&    or 
\&    
\&    install oracle 10XE http://www.oracle.com/technology/products/database/xe/index.html 
\&
\&    5) You will now need the Microsoft Visual C++ toolkit 2003. Unfortunately this product is no longer available from Microsoft.  
\&    The file name was VCToolkitSetup.exe  and is available at this mirror site http://www.filewatcher.com/m/VCToolkitSetup.exe.32952488.0.0.html at the time of writing.
\&    Microsoft\*(Aqs replacement for this tool kit is Visual C++ 2005 Express Edition and all attempts to compile DBD::Oracle with this product fail. It has been successfully compiled
\&    using a complete edition of Microsoft Visual Studio 2005. 
\&    Download and then install this product.
\&
\&    6) You will also need the Windows SDK. Which can be found at 
\&    http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43\-E24F\-4EA3\-A93E\-40C0EC4F68E5&displaylang=en
\&    You have the choice to of either to download the entire SDK and install or run an online install from the page.  
\&    Both have been tested and proven to work. 
\&
\&    7) Next download and install the Microsoft .net framework 1.1 skd from 
\&    http://www.microsoft.com/downloads/details.aspx?FamilyID=9b3a2ca6\-3647\-4070\-9f41\-a333c6b9181d&displaylang=en 
\&
\&    8) You will also need a copy of nmake.exe which you can download here http://download.microsoft.com/download/vc15/patch/1.52/w95/en\-us/nmake15.exe
\&
\&    9) Enough Downloading and installing go have a coffee.
\&
\&    10) You should at this time attempt to connect to an Oracle database with the version SQL*Plus that 
\&    you installed in step 4.  If you are unable to connect at this stage then any problems you encounter 
\&    later may have nothing to do with DBD::Oracle
\&
\&    11) On the path where you installed Visual C++ find and edit the vcvars32.bat file as follows.  You may have to modify 
\&        these path values depending where you installed the products on you computer, 
\&
\&        i.   Add  the local path to the windows platform SDK include directory to the Set INCLUDE 
\&                Command Line to include the needed files from the Windows SDK. 
\&                
\&                e.g.  "C:\eProgram Files\eMicrosoft Platform SDK\eInclude;" 
\&                
\&        ii.  Add the local path to the .net Vc7 lib directory to the Set LIB command
\&                to include the needed library file from the .Net SKD
\&                
\&                e.g. C:\eProgram Files\eMicrosoft Visual Studio .NET 2003\eVc7\elib;
\&                
\&            iii. Add the local path to the windows platform SDK Lib directory to the Set Lib command 
\&                to include the needed library files from the Windows SDK
\&                
\&            e.g. C:\eProgram Files\eMicrosoft Platform SDK\eLib;
\&
\&    12) Open a Windows Visual C++ command window from the start menu.
\&
\&    13) Add the path to the instant client to the Path command. If you are compiling aginst a 10XE db/client then you can skip steps 
\&        12 to 14. 
\&        e.g.  PATH = C:/Oracle/instantclient;%PATH%
\&    
\&    14) Using the "Set" command add "ORACLE_HOME=path to Instant client" to the environment variables.
\&        e.g. Set ORACLE_HOME=C:\eOracle\einstantclient
\&    
\&    15) Using the "Set" command add "NLS_LANG=.WE8ISO8859P15" to the environment variables. The globalization variable is required, 
\&        with this or another compatible value, by Oracle instantclient in order for it to compile correctly.
\&        e.g. Set NLS_LANG=.WE8ISO8859P15
\&
\&    16) Using the "Set" command add "ORACLE_USERID=test/test@test" substituting test with the username/password@database 
\&        you wish to run the make test files against. 
\&            Note: it is not necessary to do this step for the compile and install to work. 
\&        However: The self\-test programs included with Oracle\-DBD will mostly fail.
\&
\&    17) Move to the DBD\-Oracle directory in the Visual C++ window DOS prompt and enter the following.
\&
\&                c:\eoracle\-dbd\e>perl Makefile.PL  
\&
\&        The Makefile should then run and compile Oracle\-dbd without reporting any errors.
\&
\&    18) From this DOS prompt enter the following command
\&
\&            c:\eoracle\-dbd\e>nmake
\&
\&        The Visual C++ make executable will then build you DBD\-execuable. There should be no errors at this point.
\&
\&    19) You can test the compile by either entering
\&
\&            c:\eoracle\-dbd\e>nmake test
\&
\&        As long as you have given a valid user name, password and database name in step 15 you will see some results.  If it appears to
\&        run but you do not get a connection check the following.
\&
\&            i.   User name password and DB Name 
\&            ii.  Ensure the a valid TNSNAMES.ORA file is in the Instantclient directory
\&            iii. Attempt to log into the version of SQLPLUS that comes with Instantclient.  
\&                        If you manage to log on use the username password and TNS name with 
\&                        the Set ORACLE_USERID = and rerun the tests.
\&                    iv   If you are compiling against 10XE and have skiped steps 12 to 14 try again bu this time carry out these steps
\&
\&    20) You can now install DBD\-Oracle into you system by entering the following command from the Visual C++ window dos prompt;
\&
\&                c:\eoracle\-dbd\e>nmake install
\&
\&    21) You should now be able to run DBD\-Oracle on you system
.Ve
.SH "09/30 2006 from asu"
.IX Header "09/30 2006 from asu"
DBD::Oracle 1.18a
.PP
Linux, Debian unstable (
\&\s-1DBI: 1.52\s0
perl v5.8.8 built for i486\-linux\-gnu\-thread\-multi
)
.PP
Oracle Instant client (10.1.0.5)
.PP
The problem is in Makefile.PL. In line 130 the function find_oracle_home
is used to guess a value form \f(CW$ORACLE_HOME\fR if it is not set explicitly.
This value is used in line 138 to setup the environment (regardless
which client is used).
.PP
in line 1443 (sub get_client_version) sqlplus is used to get the
version string, but for the oracle instant client you must not set
\&\f(CW$ORACLE_HOME\fR (it will generate an error \*(L"\s-1SP2\-0642:\s0 SQL*Plus internal
error state 2165, context 4294967295:0:0\*(R")
.PP
A solution that worked for me was to set
local \f(CW$ENV\fR{\s-1ORACLE_HOME\s0} = '';
in line 1463 immediately before sqlplus is called (but I cannot tell if
this fails for full client installations)
.PP
11/30/05 \*(-- John Scoles 
I have confirmed that this Makefile.pl will work for both Oracle InstantClient
10.2.0.1 & 10.1.0.4 using same process the Andy Hassall uses. Starting with a clean \s-1OD\s0
One needs only to get the latest version of Active Perl 5.8.7 use \s-1PPM\s0 to get \s-1DBI\s0 and then
install Microsoft Visual \*(C+ toolkit, Windows \s-1SDK,\s0 and the Microsoft .net 
framework 1.1. and modify the vcvars32.bat in \*(C+ dir as follows
.PP
.Vb 9
\&   1) Add  the local path to the windows platform SDK include directory to the
\&      Set INCLUDE Command Line to include the needed files from the Windows SDK.
\&        e.g.  "C:\eProgram Files\eMicrosoft Platform SDK\eInclude;"
\&   2) Add the local path to the .net Vc7 lib directory to the Set LIB
\&      command to include the needed library files from the .Net SKD
\&        e.g. C:\eProgram Files\eMicrosoft Visual Studio .NET 2003\eVc7\elib;
\&   3) Add the local path to the windows platform SDK Lib directory to the Set Lib
\&      command to include the needed library files from the Windows SDK
\&        e.g. C:\eProgram Files\eMicrosoft Platform SDK\eLib;
.Ve
.PP
If one happens to have visual studio installed you may not have to download additional \s-1MS\s0 products.
.PP
12/01/05 \-\-\- John Scoles 
Oracle 10XE
No big problem here as 10XE seems to use the instantclient as well. Just ensure your
 \s-1NLS_LANG\s0 and \s-1ORACLE_HOME\s0 are set to the same directory that 10XE uses
.PP
10/07/05 \-\-John Scoles
Andy Hassall kindly added some changes to the Makefile.PL
so it will work for the Instant Client 10g on Windows OSs.  Below is how he set
up his environment and the steps he preformed to get it to compile.
.PP
.Vb 3
\&  Setting environment for using Microsoft Visual Studio .NET 2003 tools.
\&  (If you have another version of Visual Studio or Visual C++ installed and wish
\&  to use its tools from the command line, run vcvars32.bat for that version.)
\&
\&  C:\eDocuments and Settings\eandyh>d:
\&
\&  D:\e>cd cygwin\ehome\eandyh\esrc\epythian
\&
\&  D:\ecygwin\ehome\eandyh\esrc\epythian>set ORACLE_HOME=d:\elib\einstantclient_10_2
\&
\&  D:\ecygwin\ehome\eandyh\esrc\epythian>set NLS_LANG=.WE8ISO8859P15
\&
\&  D:\ecygwin\ehome\eandyh\esrc\epythian>set PATH=d:\elib\einstantclient_10_2;D:\eProgram F
\&  iles\eMicrosoft Visual Studio .NET 2003\eCommon7\eIDE;D:\eProgram Files\eMicrosoft Vi
\&  sual Studio .NET 2003\eVC7\eBIN;D:\eProgram Files\eMicrosoft Visual Studio .NET 2003
\&  \eCommon7\eTools;D:\eProgram Files\eMicrosoft Visual Studio .NET 2003\eCommon7\eTools\e
\&  bin\eprerelease;D:\eProgram Files\eMicrosoft Visual Studio .NET 2003\eCommon7\eTools\e
\&  bin;D:\eProgram Files\eMicrosoft Visual Studio .NET 2003\eSDK\ev1.1\ebin;C:\eWINNT\eMic
\&  rosoft.NET\eFramework\ev1.1.4322;d:\ePerl\ebin\e;C:\eWINNT\esystem32;C:\eWINNT;C:\eWINNT\e
\&  System32\eWbem;D:\eProgram Files\eMicrosoft SDK\eBin;D:\eProgram Files\eMicrosoft SDK\e
\&  Bin\eWinNT
\&
\&  D:\ecygwin\ehome\eandyh\esrc\epythian>set ORACLE_USERID=test/test@test102
\&
\&  D:\ecygwin\ehome\eandyh\esrc\epythian>perl Makefile.PL
.Ve
.PP
4/27/04 \*(-- Jeff Urlwin
.PP
Do not untar this distribution in a directory with spaces.  This will not work.
.PP
.Vb 2
\&    i.e. C:\eProgram Files\eORacle\eDBD Oracle Distribution is bad while
\&    c:\edev\edbd\-oracle\-1.15 is good ;)
.Ve
.PP
9/14/02 \*(-- Michael Chase
.PP
Makefile.PL uses Win32::TieRegistry or Win32::Registry to find the
current Oracle Home directory if the \s-1ORACLE_HOME\s0 environment variable
is not set.  If neither module is installed, you must set \s-1ORACLE_HOME\s0
before running Makefile.PL.  Since the registry location of the current
Oracle Home is in different locations in different Oracle versions,
it is usually safer to set \s-1ORACLE_HOME\s0 before running Makefile.PL.
.SH "AUTHORS"
.IX Header "AUTHORS"
.IP "\(bu" 4
Tim Bunce <timb@cpan.org>
.IP "\(bu" 4
John Scoles <byterock@cpan.org>
.IP "\(bu" 4
Yanick Champoux <yanick@cpan.org>
.IP "\(bu" 4
Martin J. Evans <mjevans@cpan.org>
.SH "COPYRIGHT AND LICENSE"
.IX Header "COPYRIGHT AND LICENSE"
This software is copyright (c) 1994 by Tim Bunce.
.PP
This is free software; you can redistribute it and/or modify it under
the same terms as the Perl 5 programming language system itself.
